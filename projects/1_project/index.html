<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AL1C3CTF</title>
    <meta name="author" content="Caleb Lerch" />
    <meta name="description" content="My personal journey and portfolio into the world of information security and ethical hacking." />
    <meta name="keywords" content="Caleb Lerch, hacking, security, cybersecurity, research, certification, analyst" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://stomper4.github.io/projects/1_project/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://stomper4.github.io/"><span class="font-weight-bold">Caleb</span>   Lerch</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">AL1C3CTF</h1>
            <p class="post-description">Making Challenges for a SAIT CTF</p>
          </header>

          <article>
            <p>I recently had the opportunity to volunteer to help out with a Capture the Flag competition hosted by SAIT (Southern Alberta Institute of Technology). The CTF was called Alice in Pwnderland.</p>

            <p>As part of the technical team, I created 4 reverse engineering challenges for the contestants to solve. My goal was to make my challenges educational. I based the challenges on skills learned in class in the ISS program to make them more accessible to contestants who were new to CTFs.</p>

            <p>The full challenges and walkthroughs can be found here: <a href=https://github.com/Stomper4/AL1C3CTF>AL1C3CTF Challenges and Write-up</a>. The rest of this article is a summary of how I structured the challenges and what I hoped the contestants could learn.</p>
            <br>

            <h2>Main Concepts</h2>

            <p>The intended solves for my challenges would take contestants through a variety of dynamic analysis reverse engineering skills, especially focusing on changing the control logic of a program to unlock additional functionality. I struggled to decide whether to add complexity to potential alternate solve paths. In the end I did not, if a contestant was good at static analysis and wanted to do it that way, I didn't want to prevent it. Hopefully they could look through my walkthroughs and learn new techniques for dynamic analysis.</p>
            <br>

            <h3>Challenge 1: Manipulating Code</h3>
            <a href=https://github.com/Stomper4/AL1C3CTF/blob/main/Mad%20Hatters%20Message/Walkthrough1/RE_chal1-walkthrough.md>Mad Hatter's Message</a>
            <p>This challenge provided contestants with obfuscated source code written in C. The source code was for a program which took 5 integer arguments and if they were correct, it printed the flag. If contestants were taking the ISS course at SAIT, this challenge required skills learned in the first semester programming class.</p>

            <p>The difficulty I had was to hide the flag in such a fashion that it wasn't just an encryption challenge. The contestant couldn't find the flag variable in the source code and attack the obfuscation of just that variable. To accomplish this, I wrote the code to derive the flag from the integer arguments entered by the user. The arguments were rotated for obfuscation, then tested against specific keys to check if they were correct. Then I created a character pointer with the same address as the integer pointer. This allowed me to work with integers in the source code, but print the flag as a string of letters.</p>

            <p>Working with the source code allowed users to re-write the logic flow of the program. My write up demonstrates how a few small changes to the code cause the program to print the flag every time it is executed, without the correct arguments.</p>
            <br>

            <h3>Challenge 2: Function Pointers</h3>
            <a href=https://github.com/Stomper4/AL1C3CTF/blob/main/Knave%20of%20Hearts'%20Payload/Walkthrough2/RE_chal2-walkthrough.md>Knave of Hearts' Payload</a>
            <p>This challenge provided contestants with shellcode that they could execute on a kali machine to print the flag. It was very easy to make (I used msfvenom) and the goal was to have contestants explore how to execute shellcode from memory. Contestants could load the code in any way they wanted, in my write up I had a basic C program that used a function pointer to load shellcode into memory, and then execute it.</p>
            
            <p>If contestants were taking the ISS program, They would have done this multiple times in the 3rd semester exploitation class.</p>
            <br>

            <h3>Challenge 3: Live Debugging</h3>
            <a href=https://github.com/Stomper4/AL1C3CTF/blob/main/Caterpillar's%20Binary/Walkthrough3/RE_chal3-walkthrough.md>Caterpillar's Binary</a>
            <p>This is the first challenge that supplied the contestants with a binary file rather than an ascii file. It was a very simple program that asks the user for a password, and if they enter the password it prints the flag. In the binary I stored the password as a hash, and the flag was encrypted, so printing ascii strings from the binary would not immediately show the answer.</p>

            <p>The intended solve was to use GDB (debugger) to explore both program flow options after the program checked the password. If the contestants were taking the ISS program, they would have learned how to do this in the second semester computer architecture class.</p>
            <br>

            <h3>Challenge 4: Altering a File</h3>
            <a href=https://github.com/Stomper4/AL1C3CTF/blob/main/The%20Mirror%20is%20Broken/Walkthrough4/RE_chal4-walkthrough.md>The Mirror is Broken</a>
            <p>This challenge was a little more CTF style random chaos. If there were experienced players that had breezed through the last 3 challenges quick, this is where I wanted to hang them up. The twist was that I reversed the entire binary, the last byte was first, etc. You could discover this by running strings, seeing they were backwards, then looking for backwards file headers to determine the file type and best way to fix. Once the file was reversed, it played a similar game as Challenge 3. The main change was a parent process that killed all execution after 5 seconds. Contestants who were debugging, no longer had time to explore all the potential program flows.</p>

            <p>My write up shows a similar attack method as I used in challenge 3, but using a different tool. I still focus on the jump logic after checking the password. Instead of using GDB debugger to change the flag in real time, I used Ghidra to overwrite the jump instruction and change the flow.</p>
            
            <br>
            <p><i>Thanks for Reading</i></p>


          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2025 Caleb Lerch. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

